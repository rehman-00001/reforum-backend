{"version":3,"sources":["../../../backend/entities/opinion/controller.js"],"names":["Opinion","require","getAllOpinions","discussion_id","Promise","resolve","reject","find","populate","sort","date","exec","error","opinions","console","log","createOpinion","forum_id","user_id","content","newOpinion","discussion","user","Date","save","updateOpinion","opinion_id","deleteOpinion","remove","_id","module","exports"],"mappings":";;AAAA;AACA,IAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;AAEA;;;;;;;AAKA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,aAAD,EAAmB;AACxC,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCN,IAAAA,OAAO,CACNO,IADD,CACM;AAAEJ,MAAAA,aAAa,EAAbA;AAAF,KADN,EAECK,QAFD,CAEU,MAFV,EAGCC,IAHD,CAGM;AAAEC,MAAAA,IAAI,EAAE,CAAC;AAAT,KAHN,EAICC,IAJD,CAIM,UAACC,KAAD,EAAQC,QAAR,EAAqB;AACzB,UAAID,KAAJ,EAAW;AAAEE,QAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AAAoBN,QAAAA,MAAM,CAACM,KAAD,CAAN;AAAgB,OAAjD,MACK,IAAI,CAACC,QAAL,EAAeP,MAAM,CAAC,IAAD,CAAN,CAAf,KACAD,OAAO,CAACQ,QAAD,CAAP;AACN,KARD;AASD,GAVM,CAAP;AAWD,CAZD;AAcA;;;;;;;;;;AAQA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,OAAmD;AAAA,MAAhDC,QAAgD,QAAhDA,QAAgD;AAAA,MAAtCd,aAAsC,QAAtCA,aAAsC;AAAA,MAAvBe,OAAuB,QAAvBA,OAAuB;AAAA,MAAdC,OAAc,QAAdA,OAAc;AACvE,SAAO,IAAIf,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAMc,UAAU,GAAG,IAAIpB,OAAJ,CAAY;AAC7BiB,MAAAA,QAAQ,EAARA,QAD6B;AAE7Bd,MAAAA,aAAa,EAAbA,aAF6B;AAG7BkB,MAAAA,UAAU,EAAElB,aAHiB;AAI7Be,MAAAA,OAAO,EAAPA,OAJ6B;AAK7BI,MAAAA,IAAI,EAAEJ,OALuB;AAM7BC,MAAAA,OAAO,EAAPA,OAN6B;AAO7BT,MAAAA,IAAI,EAAE,IAAIa,IAAJ;AAPuB,KAAZ,CAAnB;AAUAH,IAAAA,UAAU,CAACI,IAAX,CAAgB,UAACZ,KAAD,EAAW;AACzB,UAAIA,KAAJ,EAAW;AAAEE,QAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AAAoBN,QAAAA,MAAM,CAACM,KAAD,CAAN;AAAgB,OAAjD,MACK;AAAEP,QAAAA,OAAO,CAACe,UAAD,CAAP;AAAsB;AAC9B,KAHD;AAID,GAfM,CAAP;AAgBD,CAjBD;;AAmBA,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACC,UAAD,EAAgB,CACpC;AACD,CAFD;AAIA;;;;;;;AAKA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACD,UAAD,EAAgB;AACpC,SAAO,IAAItB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCN,IAAAA,OAAO,CACN4B,MADD,CACQ;AAAEC,MAAAA,GAAG,EAAEH;AAAP,KADR,EAECf,IAFD,CAEM,UAACC,KAAD,EAAW;AACf,UAAIA,KAAJ,EAAW;AAAEE,QAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AAAoBN,QAAAA,MAAM,CAACM,KAAD,CAAN;AAAgB,OAAjD,MACKP,OAAO,CAAC,SAAD,CAAP;AACN,KALD;AAMD,GAPM,CAAP;AAQD,CATD;;AAWAyB,MAAM,CAACC,OAAP,GAAiB;AACf7B,EAAAA,cAAc,EAAdA,cADe;AAEfc,EAAAA,aAAa,EAAbA,aAFe;AAGfS,EAAAA,aAAa,EAAbA,aAHe;AAIfE,EAAAA,aAAa,EAAbA;AAJe,CAAjB","sourcesContent":["// models\nconst Opinion = require('./model');\n\n/**\n * get all opinion regarding a single discussion\n * @param  {ObjectId} discussion_id\n * @return {Promise}\n */\nconst getAllOpinions = (discussion_id) => {\n  return new Promise((resolve, reject) => {\n    Opinion\n    .find({ discussion_id })\n    .populate('user')\n    .sort({ date: -1 })\n    .exec((error, opinions) => {\n      if (error) { console.log(error); reject(error); }\n      else if (!opinions) reject(null);\n      else resolve(opinions);\n    });\n  });\n};\n\n/**\n * create an opinion regarding a discussion\n * @param  {ObjectId} forum_id\n * @param  {ObjectId} discussion_id\n * @param  {ObjectId} user_id\n * @param  {Object} content\n * @return {Promise}\n */\nconst createOpinion = ({ forum_id, discussion_id, user_id, content }) => {\n  return new Promise((resolve, reject) => {\n    const newOpinion = new Opinion({\n      forum_id,\n      discussion_id,\n      discussion: discussion_id,\n      user_id,\n      user: user_id,\n      content,\n      date: new Date(),\n    });\n\n    newOpinion.save((error) => {\n      if (error) { console.log(error); reject(error); }\n      else { resolve(newOpinion); }\n    });\n  });\n};\n\nconst updateOpinion = (opinion_id) => {\n  // TODO: implement update for opinion\n};\n\n/**\n * delete a single opinion\n * @param  {ObjectId} opinion_id\n * @return {Promise}\n */\nconst deleteOpinion = (opinion_id) => {\n  return new Promise((resolve, reject) => {\n    Opinion\n    .remove({ _id: opinion_id })\n    .exec((error) => {\n      if (error) { console.log(error); reject(error); }\n      else resolve('deleted');\n    });\n  });\n};\n\nmodule.exports = {\n  getAllOpinions,\n  createOpinion,\n  updateOpinion,\n  deleteOpinion,\n};\n"],"file":"controller.js"}