{"version":3,"sources":["../../../backend/entities/discussion/api.js"],"names":["checkAuth","require","getDiscussion","createDiscussion","toggleFavorite","deleteDiscussion","discussionAPI","app","get","req","res","discussion_slug","params","then","result","send","error","put","discussion_id","console","log","userId","discussionUpdated","post","body","_doc","postCreated","deleted","module","exports"],"mappings":";;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,8BAAD,CAAzB,C,CACA;;;AACA,IAAMC,aAAa,GAAGD,OAAO,CAAC,cAAD,CAAP,CAAwBC,aAA9C;;AACA,IAAMC,gBAAgB,GAAGF,OAAO,CAAC,cAAD,CAAP,CAAwBE,gBAAjD;;AACA,IAAMC,cAAc,GAAGH,OAAO,CAAC,cAAD,CAAP,CAAwBG,cAA/C;;AACA,IAAMC,gBAAgB,GAAGJ,OAAO,CAAC,cAAD,CAAP,CAAwBI,gBAAjD;AAEA;;;;;AAGA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAS;AAC7B;AACAA,EAAAA,GAAG,CAACC,GAAJ,CAAQ,kCAAR,EAA4C,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,QAChDC,eADgD,GAC5BF,GAAG,CAACG,MADwB,CAChDD,eADgD;AAExDT,IAAAA,aAAa,CAACS,eAAD,CAAb,CAA+BE,IAA/B,CACE,UAACC,MAAD,EAAY;AACVJ,MAAAA,GAAG,CAACK,IAAJ,CAASD,MAAT;AACD,KAHH,EAIE,UAACE,KAAD,EAAW;AACTN,MAAAA,GAAG,CAACK,IAAJ,CAASC,KAAT;AACD,KANH;AAQD,GAVD,EAF6B,CAc7B;;AACAT,EAAAA,GAAG,CAACU,GAAJ,CAAQ,+CAAR,EAAyD,UAACR,GAAD,EAAMC,GAAN,EAAc;AAAA,QAC7DQ,aAD6D,GAC3CT,GAAG,CAACG,MADuC,CAC7DM,aAD6D;;AAErE,QAAIlB,SAAS,CAACS,GAAD,CAAb,EAAoB;AAClBU,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBX,GAAG,CAACY,MAA5B;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,aAA9B;AACAd,MAAAA,cAAc,CAACc,aAAD,EAAgBT,GAAG,CAACY,MAApB,CAAd,CAA0CR,IAA1C,CACE,UAACC,MAAD;AAAA,eACEZ,aAAa,CAACY,MAAM,CAACH,eAAR,CAAb,CAAsCE,IAAtC,CACE,UAACC,MAAD;AAAA,iBAAYJ,GAAG,CAACK,IAAJ,CAASD,MAAT,CAAZ;AAAA,SADF,EAEE,UAACE,KAAD;AAAA,iBAAWN,GAAG,CAACK,IAAJ,CAAS;AAAEO,YAAAA,iBAAiB,EAAE;AAArB,WAAT,CAAX;AAAA,SAFF,CADF;AAAA,OADF,EAME,UAACN,KAAD;AAAA,eAAWN,GAAG,CAACK,IAAJ,CAAS;AAAEO,UAAAA,iBAAiB,EAAE;AAArB,SAAT,CAAX;AAAA,OANF;AAQD,KAXD,MAWO;AACLZ,MAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEO,QAAAA,iBAAiB,EAAE;AAArB,OAAT;AACD;AACF,GAhBD,EAf6B,CAiC7B;;AACAf,EAAAA,GAAG,CAACgB,IAAJ,CAAS,+BAAT,EAA0C,UAACd,GAAD,EAAMC,GAAN,EAAc;AACtD,QAAIV,SAAS,CAACS,GAAD,CAAb,EAAoB;AAClBN,MAAAA,gBAAgB,CAACM,GAAG,CAACe,IAAL,CAAhB,CAA2BX,IAA3B,CACE,UAACC,MAAD,EAAY;AACVJ,QAAAA,GAAG,CAACK,IAAJ,CAAS,0BAAc,EAAd,EAAkBD,MAAM,CAACW,IAAzB,EAA+B;AAAEC,UAAAA,WAAW,EAAE;AAAf,SAA/B,CAAT;AACD,OAHH,EAIE,UAACV,KAAD,EAAW;AACTN,QAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEW,UAAAA,WAAW,EAAE;AAAf,SAAT;AACD,OANH;AAQD,KATD,MASO;AACLhB,MAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEW,QAAAA,WAAW,EAAE;AAAf,OAAT;AACD;AACF,GAbD,EAlC6B,CAiD7B;;AACAnB,EAAAA,GAAG,UAAH,CACE,mDADF,EAEE,UAACE,GAAD,EAAMC,GAAN,EAAc;AACZ,QAAIV,SAAS,CAACS,GAAD,CAAb,EAAoB;AAClBJ,MAAAA,gBAAgB,CAACI,GAAG,CAACG,MAAJ,CAAWD,eAAZ,CAAhB,CAA6CE,IAA7C,CACE,UAACC,MAAD,EAAY;AACVJ,QAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEY,UAAAA,OAAO,EAAE;AAAX,SAAT;AACD,OAHH,EAIE,UAACX,KAAD,EAAW;AACTN,QAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEY,UAAAA,OAAO,EAAE;AAAX,SAAT;AACD,OANH;AAQD,KATD,MASO;AACLjB,MAAAA,GAAG,CAACK,IAAJ,CAAS;AAAEY,QAAAA,OAAO,EAAE;AAAX,OAAT;AACD;AACF,GAfH;AAiBD,CAnED;;AAqEAC,MAAM,CAACC,OAAP,GAAiBvB,aAAjB","sourcesContent":["const checkAuth = require('./../../utilities/check-auth');\n// discussion controllers\nconst getDiscussion = require('./controller').getDiscussion;\nconst createDiscussion = require('./controller').createDiscussion;\nconst toggleFavorite = require('./controller').toggleFavorite;\nconst deleteDiscussion = require('./controller').deleteDiscussion;\n\n/**\n * discussion apis\n */\nconst discussionAPI = (app) => {\n  // get signle discussion\n  app.get('/api/discussion/:discussion_slug', (req, res) => {\n    const { discussion_slug } = req.params;\n    getDiscussion(discussion_slug).then(\n      (result) => {\n        res.send(result);\n      },\n      (error) => {\n        res.send(error);\n      }\n    );\n  });\n\n  // toggle favorite to the discussion\n  app.put('/api/discussion/toggleFavorite/:discussion_id', (req, res) => {\n    const { discussion_id } = req.params;\n    if (checkAuth(req)) {\n      console.log('userId: ', req.userId);\n      console.log('discussionId: ', discussion_id);\n      toggleFavorite(discussion_id, req.userId).then(\n        (result) =>\n          getDiscussion(result.discussion_slug).then(\n            (result) => res.send(result),\n            (error) => res.send({ discussionUpdated: false })\n          ),\n        (error) => res.send({ discussionUpdated: false })\n      );\n    } else {\n      res.send({ discussionUpdated: false });\n    }\n  });\n\n  // create a new discussion\n  app.post('/api/discussion/newDiscussion', (req, res) => {\n    if (checkAuth(req)) {\n      createDiscussion(req.body).then(\n        (result) => {\n          res.send(Object.assign({}, result._doc, { postCreated: true }));\n        },\n        (error) => {\n          res.send({ postCreated: false });\n        }\n      );\n    } else {\n      res.send({ postCreated: false });\n    }\n  });\n\n  // delete a discussion\n  app.delete(\n    '/api/discussion/deleteDiscussion/:discussion_slug',\n    (req, res) => {\n      if (checkAuth(req)) {\n        deleteDiscussion(req.params.discussion_slug).then(\n          (result) => {\n            res.send({ deleted: true });\n          },\n          (error) => {\n            res.send({ deleted: false });\n          }\n        );\n      } else {\n        res.send({ deleted: false });\n      }\n    }\n  );\n};\n\nmodule.exports = discussionAPI;\n"],"file":"api.js"}