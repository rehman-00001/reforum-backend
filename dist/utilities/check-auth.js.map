{"version":3,"sources":["../../backend/utilities/check-auth.js"],"names":["jwt","require","isAuthenticated","req","method","url","startsWith","token","headers","authorization","split","decodedToken","verify","process","env","JWT_KEY","userId","err","module","exports"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,GAAD,EAAS;AAC/B,MAAIA,GAAG,CAACC,MAAJ,KAAe,SAAf,IAA4B,CAACD,GAAG,CAACE,GAAJ,CAAQC,UAAR,CAAmB,OAAnB,CAAjC,EAA8D;AAC5D,WAAO,IAAP;AACD;;AAED,MAAI;AACF,QAAMC,KAAK,GAAGJ,GAAG,CAACK,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd,CADE,CACqD;;AACvD,QAAI,CAACH,KAAL,EAAY;AACV,aAAO,KAAP;AACD;;AACD,QAAMI,YAAY,GAAGX,GAAG,CAACY,MAAJ,CAAWL,KAAX,EAAkBM,OAAO,CAACC,GAAR,CAAYC,OAA9B,CAArB;AACAZ,IAAAA,GAAG,CAACa,MAAJ,GAAaL,YAAY,CAACK,MAA1B;AACA,WAAO,IAAP;AACD,GARD,CAQE,OAAOC,GAAP,EAAY;AACZ,WAAO,KAAP;AACD;AACF,CAhBD;;AAkBAC,MAAM,CAACC,OAAP,GAAiBjB,eAAjB","sourcesContent":["const jwt = require('jsonwebtoken');\n\nconst isAuthenticated = (req) => {\n  if (req.method === 'OPTIONS' || !req.url.startsWith('/api/')) {\n    return true;\n  }\n\n  try {\n    const token = req.headers.authorization.split(' ')[1]; // Authorization: 'Bearer TOKEN'\n    if (!token) {\n      return false;\n    }\n    const decodedToken = jwt.verify(token, process.env.JWT_KEY);\n    req.userId = decodedToken.userId;\n    return true;\n  } catch (err) {\n    return false;\n  }\n};\n\nmodule.exports = isAuthenticated;\n"],"file":"check-auth.js"}